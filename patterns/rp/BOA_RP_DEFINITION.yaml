# BOA & Resolution Protocol Definition
# Extracted from vcdesign_core_with_rp.yaml (v1.1)
# Intended to be moved to the BOA repository.
#
# v1.2 (PR-2): Responsibility Pool Escalation (routing extension)
# - Adds routing actions to return unresolved items to human OR responsibility pool.
# - Keeps existing Resolution promotion interlock (gate_rules) unchanged.
# - IMPORTANT: queueing to a pool is NOT a Resolution. Ownership must be explicitly assigned.

protocols:
  rp:
    id: rp
    version: "1.2"
    name:
      en: Resolution Protocol (RP)
      ja: 解決プロトコル（RP）
    role:
      en: Pre-decision interlock for Resolution promotion.
      ja: Resolution 昇格のための判断前インターロック

    non_goals:
      - en: Operational procedure or runbook.
        ja: 運用手順・マニュアル
      - en: Delegating or automating judgment.
        ja: 判断の代行・自動化

    applies_to:
      - resolution
      - boundary_crossing_into_responsibility

    fail_safe:
      default: deny
      on_violation: quarantine

    # -------------------------------------------------------------------------
    # Invariants (must always hold)
    # -------------------------------------------------------------------------
    invariants:
      - id: rp.inv.responsible_actor_required
        en: A named responsible actor is required for any resolution.
        ja: いかなる Resolution にも責務主体（人/組織）の明記が必要

      - id: rp.inv.ai_cannot_finalize
        en: AI systems must not finalize resolution; they may only propose candidates.
        ja: AI は最終判断できず、候補提示に限定される

      - id: rp.inv.fact_evidence_required
        en: Evidence must reference Facts and Decision Traces; unstated assumptions are invalid.
        ja: 根拠は Fact と Decision Trace を参照し、暗黙前提は無効

      - id: rp.inv.time_bound
        en: Resolution must be purpose-bound and time-bound.
        ja: Resolution は目的と期限（適用範囲）を持たねばならない

      # PR-2 additions (pool escalation safety)
      - id: rp.inv.pool_queue_is_not_resolution
        en: Enqueuing to a responsibility pool is a tracked waiting state, not a completed resolution.
        ja: 責任プールへの投入（キュー）は解決ではなく「解決待ち」の追跡状態である

      - id: rp.inv.ownership_must_be_explicit
        en: Responsibility must not be considered owned until an explicit owner assignment is recorded.
        ja: 明示的な担当割当が記録されるまで、責任が「確定した」とみなしてはならない

    # -------------------------------------------------------------------------
    # Gate rules (for Resolution promotion)
    # NOTE: These rules govern promotion into responsibility (Resolution).
    # Routing/return actions are defined separately under "routing".
    # -------------------------------------------------------------------------
    gate_rules:
      require:
        - responsible_actor
        - purpose
        - scope
        - expiry
        - evide
