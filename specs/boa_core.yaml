# boa_core.yaml
# BOA — Boundary-Oriented Architecture
#
# This file is the authoritative core specification of BOA.
# All normative definitions live under /boa/specs.
#
# BOA is governed by VCDesign Core and must not redefine
# value, judgment, or responsibility.

boa_core:
  name: "Boundary-Oriented Architecture"
  short_name: "BOA"
  version: "1.1.0"
  status: "frozen"

  governed_by:
    vcdesign_core:
      authoritative_spec: "/specs/vcdesign_core.yaml"
      guarantees:
        - "does_not_redefine_value"
        - "does_not_redefine_judgment"
        - "does_not_redefine_responsibility"

  intent:
    description: >
      BOA structures systems around explicit boundaries.
      At each boundary, judgments are either evaluated for
      determinability or formally handed off without silence.
    non_goals:
      - define_business_value
      - decide_outcomes
      - automate_responsibility
      - optimize_judgments

  # -------------------------------------------------------------------
  # Boundary Definition (Admission Contract)
  # -------------------------------------------------------------------
  boundary_definition:
    concept: "Boundary as an Admission Contract for RCA"
    description: >
      A boundary is explicitly defined by the set of conditions 
      that must be met before an RCA can accept responsibility.
    
    admission_contract: # RCAに渡すための必須入力項目
      required_fields:
        - scope_declared      # 何を判断するのか
        - owner_declared      # 誰（またはどのプール）が持つのか
        - evidence_attached   # 根拠は何か（Log/Metrics）
        - risk_class          # 失敗時の許容度
        - rollback_path       # ダメだった時の戻し方
      
      behavior_on_violation: "Reject before RCA processing (or Force Close as UNKNOWN)"

  # -------------------------------------------------------------------
  # Core components (normative)
  # -------------------------------------------------------------------
  components:

    boundary:
      description: >
        A boundary represents an interface where judgment
        may be attempted.
      guarantees:
        - "explicit_scope"
        - "explicit_interface"
        - "no_implicit_escalation"

    responsibility_closure_agent:
      name: "Responsibility Closure Agent (RCA)"
      role: >
        Evaluates input and explicitly accepts (signs), rejects,
        or delegates responsibility for a judgment.
      authoritative_spec: "/specs/responsibility_closure_agent.yaml"
      version: "1.0.0" # Frozen reference
      guarantees:
        - "does_not_silently_pass"
        - "requires_signature_for_acceptance"
        - "explicit_unknown_state"

    resolution_protocol:
      name: "Resolution Protocol (RP)"
      role: >
        Controls elevation from Meaning to Resolution
        after RCA acceptance.
      authoritative_spec: "/specs/resolution_protocol.yaml"
      version: "1.3.0" # Frozen reference
      prerequisites:
        - "rca_assessment exists"
      promotion_allowed_when:
        - "rca_assessment.state == ACCEPTED"
      guarantees:
        - "no_resolution_without_responsible_actor"
        - "no_silent_resolution"
        - "formal_handoff_on_failure"

  # -------------------------------------------------------------------
  # Canonical judgment flow (normative)
  # -------------------------------------------------------------------
  judgment_flow:
    description: >
      Canonical and non-bypassable judgment flow in BOA.
    steps:
      - step: attempt_judgment
        description: "A judgment is requested within a boundary."

      - step: responsibility_assessment
        component: responsibility_closure_agent
        description: >
          RCA evaluates whether to accept responsibility for the judgment.

      - step: closure_branch
        branches:
          ACCEPTED:
            next: resolution_protocol
          DENIED:
            next: resolution_protocol
            note: "Must NOT proceed. Stop or Retry."
          UNKNOWN:
            next: resolution_protocol
            note: "Escalate or Pool."

      - step: resolution_protocol
        description: >
          RP either promotes to Resolution (if ACCEPTED) or formally routes
          the case to human judgment or responsibility pool.

  # -------------------------------------------------------------------
  # Invariants (non-negotiable)
  # -------------------------------------------------------------------
  invariants:
    - "All judgments must pass through RCA before RP"
    - "RP must not be invoked without an RCA assessment"
    - "No component may elevate to Resolution without RP"
    - "Denial (DENIED) is a valid and recordable outcome"
    - "UNKNOWN must never be treated as success"
    - "No judgment may bypass boundary declaration"

  # -------------------------------------------------------------------
  # Extension policy
  # -------------------------------------------------------------------
  extension_policy:
    allowed:
      - add_boundary_types
      - add_domain_specific_rca_policies_via_binding
      - add_routing_targets_in_rp
    forbidden:
      - bypass_rca_signature_requirement
      - auto_promote_resolution
      - redefine_responsibility
      - bypass_judgment_flow

  # -------------------------------------------------------------------
  # Positioning
  # -------------------------------------------------------------------
  positioning:
    description: >
      BOA is a reference architecture derived from VCDesign.
      It demonstrates how VCDesign constraints can be realized
      without prescribing implementation details.
    exclusivity: false

  # -------------------------------------------------------------------
  # Closure
  # -------------------------------------------------------------------
  closure:
    statement: >
      BOA guarantees that judgments either become explicit,
      responsibility-bearing resolutions or are formally
      returned without silence.
      Anything beyond this structure remains human judgment.


    responsibility_closure_agent:
      name: "Responsibility Closure Agent (RCA)"
      role: >
        Evaluates input and explicitly accepts (signs), rejects,
        or delegates responsibility for a judgment.
      authoritative_spec: "/specs/responsibility_closure_agent.yaml"

      configuration_guidance:
        recommended_structure:
          patterns_dir: "./patterns"
          profiles_index: "profiles_index.yaml"
        note: "Pattern definitions are optional but recommended for implementation."

      guarantees:
        - "does_not_silently_pass"
        - "requires_signature_for_acceptance"
        - "explicit_unknown_state"
